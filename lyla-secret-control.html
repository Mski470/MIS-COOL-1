<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ù†ØµØ© | Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù„ÙŠØ§</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />

    <style>
      :root {
        --primary-blue: #3b82f6;
        --accent-purple: #8b5cf6;
        --bg-dark: #0a0f18;
        --card-bg: #1e293b;
        --text-white: #f8fafc;
        --danger: #ef4444;
        --success: #10b981;
      }

      body {
        font-family: "Tajawal", sans-serif;
        background-color: var(--bg-dark);
        color: var(--text-white);
        margin: 0;
        padding: 20px;
        display: flex;
        justify-content: center;
      }

      .admin-container {
        max-width: 900px;
        width: 100%;
        background: var(--card-bg);
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .header {
        text-align: center;
        margin-bottom: 40px;
      }

      .header i {
        font-size: 3rem;
        color: var(--primary-blue);
        margin-bottom: 15px;
      } /* ØªØ§Ø¨Ø¹ Ø§Ù„Ù€ CSS Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª */
      .form-group {
        margin-bottom: 20px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: var(--text-muted);
        font-size: 0.9rem;
      }

      input,
      select {
        width: 100%;
        padding: 12px 15px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        color: white;
        font-family: "Tajawal", sans-serif;
        font-size: 1rem;
        transition: var(--transition);
      }

      input:focus,
      select:focus {
        outline: none;
        border-color: var(--primary-blue);
        background: rgba(255, 255, 255, 0.1);
        box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
      }

      .upload-btn {
        width: 100%;
        padding: 15px;
        background: linear-gradient(
          45deg,
          var(--primary-blue),
          var(--accent-purple)
        );
        border: none;
        border-radius: 12px;
        color: white;
        font-weight: 700;
        font-size: 1.1rem;
        cursor: pointer;
        transition: var(--transition);
        margin-top: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
      }

      .upload-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 20px rgba(59, 130, 246, 0.3);
        filter: brightness(1.1);
      }

      .upload-btn:active {
        transform: translateY(0);
      }

      /* ØªÙ†Ø³ÙŠÙ‚ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø© */
      .data-list {
        margin-top: 50px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        padding-top: 30px;
      }

      .data-item {
        background: rgba(255, 255, 255, 0.03);
        padding: 15px 20px;
        border-radius: 15px;
        margin-bottom: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border: 1px solid rgba(255, 255, 255, 0.05);
      }
    </style>
  </head>
  <body>
    <div class="admin-container animate__animated animate__fadeIn">
      <div class="header">
        <i class="fas fa-user-shield"></i>
        <h1>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ©</h1>
        <p>Ø¥Ø¯Ø§Ø±Ø© Ù…Ø­ØªÙˆÙ‰ Ù…Ù†ØµØ© ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„ØªØ¹Ù„ÙŠÙ… 2026</p>
      </div>

      <div class="upload-section">
        <div class="form-group">
          <label><i class="fas fa-edit"></i> Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø© Ø£Ùˆ Ø§Ù„Ù…Ù„Ù</label>
          <input
            type="text"
            id="fileName"
            placeholder="Ù…Ø«Ø§Ù„: Ù…Ù‚Ø¯Ù…Ø© ÙÙŠ ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„ØªØ¹Ù„ÙŠÙ…"
          />
        </div>

        <div class="form-group">
          <label
            ><i class="fas fa-link"></i> Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù„Ù (Drive / YouTube /
            Forms)</label
          >
          <input
            type="url"
            id="fileUrl"
            placeholder="https://example.com/your-link"
          />
        </div>

        <div class="form-group">
          <label><i class="fas fa-book"></i> ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</label>
          <select id="fileSubject">
            <option value="tech_edu">ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„ØªØ¹Ù„ÙŠÙ…</option>
            <option value="cs_intro">Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³Ø¨</option>
            <option value="digital_photo">Ø§Ù„ØªØµÙˆÙŠØ± Ø§Ù„Ø±Ù‚Ù…ÙŠ</option>
            <option value="learning_res">Ù…ØµØ§Ø¯Ø± Ø§Ù„ØªØ¹Ù„Ù…</option>
            <option value="comm_skills">Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„</option>
            <option value="edu_science">Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„ØªØ±Ø¨ÙˆÙŠØ©</option>
            <option value="curriculum">Ø§Ù„Ù…Ù†Ø§Ù‡Ø¬ ÙˆØªÙ†Ø¸ÙŠÙ…Ù‡Ø§</option>
            <option value="social_issues">Ù‚Ø¶Ø§ÙŠØ§ Ù…Ø¬ØªÙ…Ø¹ÙŠØ©</option>
          </select>
        </div>
        <div class="form-group">
          <label><i class="fas fa-layer-group"></i> Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰</label>
          <select id="fileType">
            <option value="files">Ù…Ù„Ù PDF / Ù…Ù„Ø²Ù…Ø©</option>
            <option value="videos">Ù…Ø­Ø§Ø¶Ø±Ø© ÙÙŠØ¯ÙŠÙˆ (YouTube)</option>
            <option value="exams">Ø±Ø§Ø¨Ø· Ø§Ù…ØªØ­Ø§Ù† (Google Forms)</option>
          </select>
        </div>

        <button class="upload-btn" onclick="uploadData()">
          <i class="fas fa-cloud-upload-alt"></i> Ù†Ø´Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¢Ù†
        </button>
      </div>

      <div class="data-list">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
          "
        >
          <h2 style="font-size: 1.2rem; color: var(--success)">
            <i class="fas fa-database"></i> Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù†Ø´ÙˆØ± Ø­Ø§Ù„ÙŠØ§Ù‹
          </h2>
          <span
            id="dataCounter"
            style="
              font-size: 0.8rem;
              background: var(--primary-blue);
              padding: 2px 10px;
              border-radius: 20px;
            "
            >Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹Ø¯...</span
          >
        </div>

        <div id="adminDataList">
          <div
            class="loader-container"
            style="text-align: center; padding: 20px"
          >
            <div
              class="loader"
              style="
                width: 30px;
                height: 30px;
                border-width: 3px;
                margin: 0 auto;
              "
            ></div>
          </div>
        </div>
      </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script>
      // 1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase (ØªØ£ÙƒØ¯ÙŠ Ù…Ù† Ù…Ø·Ø§Ø¨Ù‚ØªÙ‡Ø§ Ù„Ù…Ø´Ø±ÙˆØ¹Ùƒ)
      const firebaseConfig = {
        apiKey: "AIzaSyA4_aX-sRYpzZITrt0fF82ONoeb4d71GUA",
        authDomain: "maath-library-2026.firebaseapp.com",
        projectId: "maath-library-2026",
        storageBucket: "maath-library-2026.firebasestorage.app",
        messagingSenderId: "667101666048",
        appId: "1:667101666048:web:220bcfef7157c9b369b1e5",
      };

      // ØªÙ‡ÙŠØ¦Ø© Firebase Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
      if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
      }
      const db = firebase.firestore();

      // 2. Ø¯Ø§Ù„Ø© Ø±ÙØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ
      async function uploadData() {
        const name = document.getElementById("fileName").value.trim();
        const url = document.getElementById("fileUrl").value.trim();
        const subject = document.getElementById("fileSubject").value;
        const type = document.getElementById("fileType").value;

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ù‚ÙˆÙ„
        if (!name || !url) {
          alert("ÙŠØ§ ØºØ§Ù„ÙŠØ©ØŒ Ù„Ø§Ø²Ù… ØªÙƒØªØ¨ÙŠ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø±Ø§Ø¨Ø· Ø£ÙˆÙ„Ø§Ù‹! âš ï¸");
          return;
        }

        try {
          // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù€ Firestore
          await db.collection("files").add({
            name: name,
            url: url,
            subject: subject,
            type: type, // (files, videos, exams)
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
          });

          alert("ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­! Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¢Ù† Ù…ØªØ§Ø­ Ù„Ù„Ø·Ù„Ø§Ø¨ âœ…");

          // ØªÙØ±ÙŠØº Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ø¬Ø§Ø­
          document.getElementById("fileName").value = "";
          document.getElementById("fileUrl").value = "";
        } catch (error) {
          console.error("Error adding document: ", error);
          alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ØªÙ‚Ù†ÙŠØŒ Ø­Ø§ÙˆÙ„ÙŠ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ÙŠØ§ ÙÙ†Ø§Ù†Ø©");
        }
      } // 3. Ø¯Ø§Ù„Ø© Ø¬Ù„Ø¨ ÙˆØ¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
      function loadAdminData() {
        const listDiv = document.getElementById("adminDataList");
        const counter = document.getElementById("dataCounter");

        // Ù‚Ø§Ù…ÙˆØ³ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ù„Ø£Ø³Ù…Ø§Ø¡ Ø¹Ø±Ø¨ÙŠØ© (Ù„Ù„Ø¹Ø±Ø¶ ÙÙ‚Ø· Ù‡Ù†Ø§)
        const subjectNames = {
          tech_edu: "ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„ØªØ¹Ù„ÙŠÙ…",
          cs_intro: "Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³Ø¨",
          digital_photo: "Ø§Ù„ØªØµÙˆÙŠØ± Ø§Ù„Ø±Ù‚Ù…ÙŠ",
          learning_res: "Ù…ØµØ§Ø¯Ø± Ø§Ù„ØªØ¹Ù„Ù…",
          comm_skills: "Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„",
          edu_science: "Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„ØªØ±Ø¨ÙˆÙŠØ©",
          curriculum: "Ø§Ù„Ù…Ù†Ø§Ù‡Ø¬ ÙˆØªÙ†Ø¸ÙŠÙ…Ù‡Ø§",
          social_issues: "Ù‚Ø¶Ø§ÙŠØ§ Ù…Ø¬ØªÙ…Ø¹ÙŠØ©",
        };

        // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­ÙŠØ§Ù‹ Ù…Ù† Firebase
        db.collection("files")
          .orderBy("createdAt", "desc")
          .onSnapshot((snapshot) => {
            listDiv.innerHTML = "";
            counter.innerText = `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù†Ø§ØµØ±: ${snapshot.size}`;

            if (snapshot.empty) {
              listDiv.innerHTML =
                "<p style='text-align:center; color:gray;'>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰ Ù…Ù†Ø´ÙˆØ± Ø­Ø§Ù„ÙŠØ§Ù‹.</p>";
              return;
            }

            snapshot.forEach((doc) => {
              const item = doc.data();
              const sName = subjectNames[item.subject] || item.subject;

              // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù†ÙˆØ¹
              let typeIcon = "fa-file-pdf";
              let typeColor = "#3b82f6";
              if (item.type === "videos") {
                typeIcon = "fa-video";
                typeColor = "#ef4444";
              }
              if (item.type === "exams") {
                typeIcon = "fa-graduation-cap";
                typeColor = "#10b981";
              }

              listDiv.innerHTML += `
                        <div class="data-item animate__animated animate__fadeInUp">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div style="color: ${typeColor}; font-size: 1.2rem;">
                                    <i class="fas ${typeIcon}"></i>
                                </div>
                                <div>
                                    <strong style="display:block;">${item.name}</strong>
                                    <small style="color: #94a3b8;">Ø§Ù„Ù…Ø§Ø¯Ø©: ${sName}</small>
                                </div>
                            </div>
                            <button class="delete-btn" onclick="deleteDoc('${doc.id}')" 
                                    style="background: rgba(239, 68, 68, 0.1); color: #ef4444; border: none; padding: 8px 12px; border-radius: 8px; cursor: pointer;">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    `;
            });
          });
      }

      // 4. Ø¯Ø§Ù„Ø© Ø­Ø°Ù Ø¹Ù†ØµØ± Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹
      async function deleteDoc(id) {
        if (confirm("Ù‡Ù„ Ø£Ù†ØªÙ Ù…ØªØ£ÙƒØ¯Ø© Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ ğŸ—‘ï¸")) {
          try {
            await db.collection("files").doc(id).delete();
            alert("ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨Ù†Ø¬Ø§Ø­!");
          } catch (error) {
            alert("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù!");
          }
        }
      }

      // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¬Ù„Ø¨ ÙÙˆØ± ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
      window.onload = loadAdminData;
    </script>
  </body>
</html>
