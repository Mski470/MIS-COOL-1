<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>معرض المحاضرات المرئية | منصة تكنولوجيا التعليم</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <link rel="stylesheet" href="style.css" />

    <style>
      /* ستايل وضع السينما للفيديوهات */
      .video-hero {
        background: linear-gradient(135deg, #ef4444 0%, #991b1b 100%);
        padding: 50px 40px;
        border-radius: 25px;
        margin-bottom: 30px;
        color: white;
        box-shadow: 0 15px 35px rgba(239, 68, 68, 0.2);
      }
      .video-card {
        background: var(--card-bg);
        border-radius: 20px;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.05);
        transition: var(--transition);
      }
      .video-card:hover {
        transform: translateY(-10px);
        border-color: #ef4444;
      }
      .video-thumbnail {
        width: 100%;
        height: 180px;
        background: #000;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
      }
      .play-overlay {
        position: absolute;
        font-size: 3rem;
        color: rgba(255, 255, 255, 0.8);
        transition: 0.3s;
      }
      .video-card:hover .play-overlay {
        color: #ef4444;
        transform: scale(1.2);
      }
    </style>
  </head>
  <body>
    <div class="loading-overlay" id="loadingOverlay">
      <div class="loader"></div>
    </div>

    <div class="app-container">
      <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <div class="logo-icon" style="background: #ef4444">
            <i class="fas fa-play"></i>
          </div>
          <h2 style="font-size: 1.1rem">تكنولوجيا التعليم</h2>
        </div>
        <nav class="sidebar-nav">
          <ul>
            <li>
              <a href="index.html" class="nav-link"
                ><i class="fas fa-th-large"></i><span>الرئيسية</span></a
              >
            </li>
            <li>
              <a href="index.html#subjects" class="nav-link"
                ><i class="fas fa-book"></i><span>المواد الدراسية</span></a
              >
            </li>
            <li>
              <a href="library.html" class="nav-link"
                ><i class="fas fa-folder-open"></i
                ><span>المكتبة الرقمية</span></a
              >
            </li>
            <li class="active">
              <a href="video-gallery.html" class="nav-link"
                ><i class="fas fa-video"></i><span>المحاضرات المرئية</span></a
              >
            </li>
            <li>
              <a href="exams.html" class="nav-link"
                ><i class="fas fa-graduation-cap"></i><span>التقييمات</span></a
              >
            </li>
          </ul>
        </nav>
      </aside>
      <main class="main-wrapper">
        <header class="top-navbar">
          <div class="header-left">
            <button class="menu-btn" id="menuToggle">
              <i class="fas fa-bars"></i>
            </button>
            <div class="search-box">
              <i class="fas fa-search"></i>
              <input
                type="text"
                id="videoSearch"
                placeholder="ابحث عن عنوان محاضرة..."
              />
            </div>
          </div>
          <div class="header-right">
            <div class="date-chip" style="background: #ef4444; color: white">
              <i class="fas fa-tv"></i> <span>بث مباشر مسجل</span>
            </div>
          </div>
        </header>

        <div class="content-body">
          <section class="video-hero animate__animated animate__fadeIn">
            <h1>مركز المحاضرات المرئية</h1>
            <p>
              شاهد وتعلم من أفضل المحاضرات التعليمية في تكنولوجيا التعليم
              والعلوم التربوية
            </p>
          </section>

          <div class="filter-section animate__animated animate__fadeInUp">
            <button
              class="filter-btn active"
              onclick="filterVideos('all', this)"
            >
              كل المحاضرات
            </button>
            <button class="filter-btn" onclick="filterVideos('tech_edu', this)">
              تكنولوجيا التعليم
            </button>
            <button class="filter-btn" onclick="filterVideos('cs_intro', this)">
              علوم الحاسب
            </button>
            <button
              class="filter-btn"
              onclick="filterVideos('digital_photo', this)"
            >
              التصوير الرقمي
            </button>
            <button
              class="filter-btn"
              onclick="filterVideos('learning_res', this)"
            >
              مصادر التعلم
            </button>
            <button
              class="filter-btn"
              onclick="filterVideos('comm_skills', this)"
            >
              مهارات التواصل
            </button>
            <button
              class="filter-btn"
              onclick="filterVideos('edu_science', this)"
            >
              العلوم التربوية
            </button>
            <button
              class="filter-btn"
              onclick="filterVideos('curriculum', this)"
            >
              المناهج
            </button>
            <button
              class="filter-btn"
              onclick="filterVideos('social_issues', this)"
            >
              قضايا مجتمعية
            </button>
          </div>

          <div
            id="videoGrid"
            class="quick-grid"
            style="grid-template-columns: repeat(auto-fill, minmax(300px, 1fr))"
          >
            <div
              class="loader-container"
              style="grid-column: 1/-1; text-align: center; padding: 50px"
            >
              <div
                class="loader"
                style="margin: 0 auto; border-top-color: #ef4444"
              ></div>
              <p style="margin-top: 15px; color: var(--text-muted)">
                جاري تجهيز استوديو العرض...
              </p>
            </div>
          </div>
        </div>
      </main>
    </div>
    ``` **نصيحة من أختك:** في الجزء ده، الـ `grid` متظبط عشان الفيديوهات تظهر
    بحجم مريح للعين (زي اليوتيوب بالظبط)، ولما الطالب يحرك الماوس على الفيديو
    هيحس بتفاعل شيك بفضل الـ CSS اللي حطيناه. قوليلي **"كملي"** عشان أبعتلك
    الجزء الثالث اللي فيه الربط مع Firebase، وده الجزء اللي هيسحب الفيديوهات بس
    ويفصلها عن الملازم.
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <script>
      // 1. إعدادات Firebase
      const firebaseConfig = {
        apiKey: "AIzaSyA4_aX-sRYpzZITrt0fF82ONoeb4d71GUA",
        authDomain: "maath-library-2026.firebaseapp.com",
        projectId: "maath-library-2026",
        storageBucket: "maath-library-2026.firebasestorage.app",
        messagingSenderId: "667101666048",
        appId: "1:667101666048:web:220bcfef7157c9b369b1e5",
      };

      if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
      }
      const db = firebase.firestore();

      let allVideos = []; // مخزن الفيديوهات للبحث السريع

      // 2. تشغيل الجلب عند فتح الصفحة
      document.addEventListener("DOMContentLoaded", () => {
        fetchVideos();

        // تفعيل البحث النصي في أسماء المحاضرات
        document
          .getElementById("videoSearch")
          .addEventListener("input", (e) => {
            const term = e.target.value.toLowerCase();
            const filtered = allVideos.filter((v) =>
              v.name.toLowerCase().includes(term)
            );
            renderVideoGrid(filtered);
          });
      });

      // 3. جلب الفيديوهات من السحابة
      function fetchVideos() {
        // بنجيب العناصر اللي نوعها (videos) فقط
        db.collection("files")
          .where("type", "==", "videos")
          .onSnapshot((snapshot) => {
            allVideos = [];
            snapshot.forEach((doc) => {
              allVideos.push({ id: doc.id, ...doc.data() });
            });
            renderVideoGrid(allVideos);

            // إخفاء التحميل
            const loader = document.getElementById("loadingOverlay");
            if (loader) loader.style.display = "none";
          });
      } // 4. دالة بناء كروت الفيديوهات السينمائية
      function renderVideoGrid(videos) {
        const grid = document.getElementById("videoGrid");
        grid.innerHTML = "";

        if (videos.length === 0) {
          grid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 50px;">
                        <i class="fas fa-video-slash" style="font-size: 3rem; color: var(--text-muted); opacity: 0.5;"></i>
                        <p style="margin-top: 15px; color: var(--text-muted);">لا توجد محاضرات فيديو متاحة في هذا القسم حالياً.</p>
                    </div>`;
          return;
        }

        videos.forEach((video) => {
          const subjectNames = {
            tech_edu: "تكنولوجيا التعليم",
            cs_intro: "علوم الحاسب",
            digital_photo: "التصوير الرقمي",
            learning_res: "مصادر التعلم",
            comm_skills: "مهارات التواصل",
            edu_science: "العلوم التربوية",
            curriculum: "المناهج",
            social_issues: "قضايا مجتمعية",
          };

          const card = document.createElement("div");
          card.className = "video-card animate__animated animate__zoomIn";

          card.innerHTML = `
                    <div class="video-thumbnail">
                        <i class="fas fa-play-circle play-overlay"></i>
                        </div>
                    <div class="card-info" style="padding: 20px;">
                        <span style="font-size: 0.75rem; color: #ef4444; font-weight: bold;">محاضرة مسجلة</span>
                        <h3 style="font-size: 1rem; margin: 8px 0; color: white;">${
                          video.name
                        }</h3>
                        <p style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 15px;">
                            المادة: ${subjectNames[video.subject] || "عام"}
                        </p>
                        <a href="${
                          video.url
                        }" target="_blank" class="btn-card" style="background: #ef4444; border-color: #ef4444; display: block; text-align: center; text-decoration: none;">
                            <i class="fas fa-play"></i> مشاهدة المحاضرة
                        </a>
                    </div>
                `;
          grid.appendChild(card);
        });
      }

      // 5. دالة التصفية (فلترة) حسب المادة
      function filterVideos(subjectCode, btn) {
        document
          .querySelectorAll(".filter-btn")
          .forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");

        if (subjectCode === "all") {
          renderVideoGrid(allVideos);
        } else {
          const filtered = allVideos.filter((v) => v.subject === subjectCode);
          renderVideoGrid(filtered);
        }
      }

      // 6. تفعيل القائمة الجانبية للموبايل
      const menuToggle = document.getElementById("menuToggle");
      const sidebar = document.getElementById("sidebar");
      if (menuToggle) {
        menuToggle.addEventListener("click", () => {
          sidebar.classList.toggle("active");
        });
      }
    </script>
  </body>
</html>
